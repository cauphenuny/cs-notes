## SPACE, NSPACE

ref: c81.pdf

> [!def] 空间复杂性
> 1. 令 $M$ 是一个在所有输入上都停机的确定性图灵机。M的空间复杂度 (space complexity)是一个函数 $f : \mathbb{N} → \mathbb{N}$, 其中$f (n)$是$M$在所有长度为$n$的输入上扫描带子方格的最大数目。
 > 若 $M$ 的空间复杂度为 $f (n)$, 则称 $M$ 在空间 $f (n)$ 内运行。
> 2. 如果 $M$ 是一个对所有输入在所有分支上都停机的非确定性图灵机，则将它的空间复杂度定义为 $M$ 对所有长为 $n$ 的输入，在任何计算分支上所扫描的带子方格的最大数。

> [!def] 空间复杂性类
> 令 $f:\mathbb{N}\to \mathbb{R}^+$ 是一个函数，那么 $\text{SPACE}(f(n))$ 和 $\text{NSPACE}(f(n))$ 定义如下：
> + $\text{SPACE}(f(n))=\{ L\mid L\text{是被} O(f(n))空间确定图灵机判定的语言的图灵机 \}$
> + $\text{NSPACE}(f(n))=\{ L\mid L\text{是被} O(f(n))空间非确定图灵机判定的语言的图灵机 \}$

^4a1ca2

> [!theorem] Savitch 定理
> 对任何函数 $f: \mathcal{N}\to \mathcal{R}^+$，其中 $f(n)\geq n$，那么有$\text{NSPACE}(f(n))\subseteq\text{SPACE}(f^{2}(n))$

> [!proof]
> 递归地使用 CANYIELD 确定性图灵机，
> > [!def] CANYIELD
> > 接受三个输入 $\langle c_{1},c_{2},t \rangle$，其中 $c_{1},c_{2}$ 是占用空间不超过 $f(n)$ 的格局，$t$ 是整数:
> > CANYEILD = "对于输入 $\langle c_{1},c_{2},t \rangle$:
> > 1. $t=1\longrightarrow$ 检查是否有 $c_{1}=c_{2}$ 或 $c_{1}$ 可以一步到 $c_{2}$
> > 2. 如果 $t>1$，考虑每个消耗空间 $f(n)$ 的格局 $c_{m}$，运行 $\text{CANYIELD}\left( \left\langle  c_{1},c_{m}, \dfrac{t}{2}  \right\rangle \right)$ 和 $\text{CANYIELD}\left( \left\langle  c_{m},c_{2}, \dfrac{t}{2}  \right\rangle \right)$，若都接受则接受（这一步重复利用了空间）
> > 3. 此时还未接受则拒绝"
> 
> 每一层递归存储两个格局和一个计数器，空间复杂度 
> $$O(f(n))+O(f(n))+O(\log(2^{O(f(n))}))=O(f(n))$$
> 递归层数 $\log t=\log 2^{O(f(n))}=O(f(n))$
> 总复杂度 $O(f^2(n))$
> 可能计算 $f(n)$ 需要的空间比 $O(f(n))$ 还多，直接计算完然后放到 CANYIELD 的参数里可能就炸了，但是时间无所谓，空间可以重复利用，我们可以假设 $f(n)=1,2,3,\dots$ 直到计算过程中不存在消耗比当前限制的空间数还多的格局时就拒绝(反之，将限制调高重来一遍)。

> [!theorem] Immerman-Szelepcsenyi 定理
> 对任意函数 $s(n) \geq \log n$，都有
> $$ \text{NSPACE}(s(n)) = \text{co-NSPACE}(s(n)) $$
> 即：**非确定性空间复杂度类在对数空间及以上对补封闭。**

可达性问题是 $\text{NSPACE}(\log)\stackrel{\text{def}}=\text{NL}$ 的：
考虑 $s$ 到 $t$ ：
最多走 $\lvert V \rvert$ 步，否则循环
非确定性地选择下一个节点，如果到了 $t$ 则接受，只需要存当前节点和计数器 $\text{cnt}$，最多 $\log \lvert V \rvert$ 位。

---
## PSPACE, NPSPACE

> [!def] 多项式空间复杂度
> $\text{PSPACE}=\bigcup_{k>0}\text{SPACE}(n^k)$
> $\text{NPSPACE}=\bigcup_{k>0}\text{NSPACE}(n^k)$

> [!theorem]
> + $\text{P}\subseteq\text{NP}\subseteq\text{PSPACE}\subseteq\text{NPSPACE}\subseteq\text{EXPTIME}$
> + $\text{P}\subseteq\text{coNP}\subseteq\text{PSPACE}\subseteq\text{NPSPACE}\subseteq\text{EXPTIME}$

![[p-levels.png]]

根据萨维奇定理，又多项式的平方还是多项式，所以 $\text{PSPACE}=\text{NPSPACE}$

$\text{P}\subseteq\text{NP}\subseteq\text{PSPACE}=\text{NPSPACE}\subseteq\text{EXPTIME}$

> [!theorem]
> $f(n)$ 空间界限 ($f(n)\geq \log n$) 的图灵机也在 $2^{O(f(n))}$ 时间内运行
> 
> 为对于亚线性的空间界限有一个比较好的定义，将格局修改为：
> > [!def] $M$ 在 $w$ 上的格局
> > 若 $M$ 是一个有单独只读输入带的图灵机，$w$ 是输入，则 $M$ 在 $w$ 上的格局包括状态、工作带和两个读写头位置，输入 $w$ （只读）不作为格局的一部分
> 
> > [!example]
> > 若 $w$ 是长为 $n$ 的输入，则空间复杂度 $O(f(n))$ 的 $M$ 在 $w$ 上的格局数是 $n \cdot 2^{O(f(n))}$

> [!proof]
> 运行时间超过格局数表示进入循环，直接拒绝
> 如果 $f(n)\geq \log n$，那么 $n \cdot 2^{O(f(n))}=2^{O(f(n))}$

> [!corollary] 推论
> [[对数空间复杂性#^22da65|L,NL]] 是多项式时间可解的

> [!theorem] 扩展的Savitch定理
> 对任何函数 $f(n):\mathcal{N}\to \mathcal{R}^+,f(n)\geq \log n$，有 $\text{NSPACE}(f(n))=\text{SPACE}(f^2(n))$

> [!proof]
> 存储 $M$ 的格局改为存储 $M$ 在输入 $w$ 上的格局，空间复杂度 $\log(n 2 ^{O(f(n))})=\log n+O(f(n))$，考虑 $f(n)\geq \log n$ 的情况，消耗就是 $O(f(n))$，其余部分跟之前证明一样

---

## PSPACE 完全性

类似 [[多项式时间复杂性#规约与 NP-Hard/Complete|P和NP完全性]] 的定义，但注意：使用多项式 **时间** 规约，因为规约的目的是求解问题，难度不能太难（超过问题本身），否则不能用于求解被规约的问题。

> [!theorem]
> [[一些 PSPACE-完全的语言#TQBF|TQBF]] 问题是 PSPACE-完全的

