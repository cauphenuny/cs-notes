张量积：
$A_{n,m}=(a_{i,j}),B_{s,t}=(b_{i,j})$
$(A\otimes B)_{ns,mt}=(a_{i,j}B)$

> [!example]
> Hadamard Matrix $H=\dfrac{1}{\sqrt{ 2 }}\begin{pmatrix}1 & 1 \\ 1 & -1\end{pmatrix}$
> $H\otimes B=\dfrac{1}{\sqrt{ 2 }}\begin{pmatrix} B & B \\ B & -B\end{pmatrix}$

---

## 张量网络

列向量

$\alpha=(a_{x})$, $x$: 行坐标指标

```
--------|
   x   alpha
```
行标画左边

$\alpha^T=(a_{x})$

```
	    x
   |---------
alpha
```

列标画右边

$A=(a_{xy})$
```
   x        y
--------|--------
        A
```

$B=(b_{yz})$
```
   y        z
--------|--------
        B
```

$AB$
```
	x       y       z
--------|-------|--------
		A       B
```

$A\otimes B$
```
	x   A   y
--------|--------
	u   B   v
--------|--------
```

```
x -----·   ·----- y
        \ /
        AxB
        / \
u -----·   ·----- v
```

选定两个枚举变量作为行指标，两个作为列指标
$(A\otimes B)_{(x,u),(y,v)}=A_{xy} \cdot B_{uv}$
$(x,u)\in \{(0,0),\dots,(n,s)\}$ 共 $ns$ 行
$(y,v)\in \{ (0,0),\dots,(m,t) \}$ 共 $mt$ 列

"结合律"

$(AB)\otimes(CD)=(A\otimes C)(B\otimes D)$

```
    x   A    y    B    z
--------|---------|---------
    u   C    v    D    s
--------|---------|---------
```

左式：先计算行

```
	x   AB   z
--------|--------
	u   CD   s
--------|--------
```

右式：先计算列
```
    x         y           z
-------.   .------.   .------
        \ /        \ /
	    AxC        BxD
	u   / \   v    / \    s
-------·   ·------·   ·------
```

## 容斥

$\{ e_{1}^i, e_{0}^i \}$ 分别表示 $\in A_{i}$ 和 $\in \overline{A}_{i}$ 的数量

通配符向量 $e_{*}^i=e_{1}^i+e_{0}^i$，表示不考虑$A_{i}$ 限制

$\begin{pmatrix}e_{1} \\ e_{*}\end{pmatrix}=\begin{pmatrix}1 & 0 \\ 1 & 1 \end{pmatrix}\begin{pmatrix}e_{1} \\ e_{0}\end{pmatrix}$

$\begin{pmatrix}e_{1}^1 \\ e_{*}^1\end{pmatrix}\otimes \begin{pmatrix}e_{1}^2 \\ e_{*}^2\end{pmatrix}=\begin{pmatrix}e_{1}^1 \otimes e_{1}^2 \\ e_{1}^1 \otimes e_{*}^2 \\ e_{*}^1\otimes e_{1}^2 \\ e_{*}^1\otimes e_{*}^2\end{pmatrix}=\begin{pmatrix}\lvert A^1\cap A^2\rvert \\ |A^1 |\\ |A^2| \\ |S|\end{pmatrix}=\begin{pmatrix}1 & 0 & 0 & 0 \\ 1 & 1 & 0 & 0 \\ 1 & 0 & 1 & 0 \\ 1 & 1 & 1 & 1\end{pmatrix}\begin{pmatrix}e_{1} \\ e_{0}\end{pmatrix}^{\otimes^2}$

验证：

$\begin{pmatrix}e_{1}^1 \\ e_{0}^1\end{pmatrix}\otimes \begin{pmatrix}e_{1}^2 \\ e_{0}^2\end{pmatrix}=\begin{pmatrix}\lvert A^1 \cap A^2 \rvert \\ \lvert A^1\cap \overline{A^2} \rvert \\ \lvert \overline{A^1}\cap A^2 \rvert \\ \lvert \overline{A^1}\cap \overline{A^2}\rvert\end{pmatrix}$

$\begin{pmatrix}\lvert A^1\cap A^2\rvert \\ |A^1 |\\ |A^2| \\ |S|\end{pmatrix}=\begin{pmatrix}1 & 0 & 0 & 0 \\ 1 & 1 & 0 & 0 \\ 1 & 0 & 1 & 0 \\ 1 & 1 & 1 & 1\end{pmatrix}\begin{pmatrix}\lvert A^1 \cap A^2 \rvert \\ \lvert A^1\cap \overline{A^2} \rvert \\ \lvert \overline{A^1}\cap A^2 \rvert \\ \lvert \overline{A^1}\cap \overline{A^2}\rvert\end{pmatrix}$

求逆：

$\begin{pmatrix}\begin{pmatrix}1 & 0 \\ 1 & 1\end{pmatrix}^{-1}\end{pmatrix}^{\otimes {2}}\begin{pmatrix}\lvert A^1\cap A^2\rvert \\ |A^1 |\\ |A^2| \\ |S|\end{pmatrix}=\cancel{ \begin{pmatrix}1 & 0 & 0 & 0 \\ 1 & 1 & 0 & 0 \\ 1 & 0 & 1 & 0 \\ 1 & 1 & 1 & 1\end{pmatrix} }\begin{pmatrix}\lvert A^1 \cap A^2 \rvert \\ \lvert A^1\cap \overline{A^2} \rvert \\ \lvert \overline{A^1}\cap A^2 \rvert \\ \lvert \overline{A^1}\cap \overline{A^2}\rvert\end{pmatrix}$

$\begin{pmatrix}1 & 0 \\ 1 &  1\end{pmatrix}^{-1}=\begin{pmatrix}1 & 0 \\ -1 & 1\end{pmatrix}$

$\begin{pmatrix}1 & 0 \\ -1 & 1\end{pmatrix}^{\otimes 2}=\begin{pmatrix}1 & 0 & 0 & 0 \\ -1 & 1 & 0 & 0 \\ -1 & 0 & 1 & 0 \\ 1 & -1 & -1 & 1\end{pmatrix}$

只关心最后一行 $\begin{pmatrix}1 & -1 & -1 & 1\end{pmatrix}$

$n$ 维的情况：

$\begin{pmatrix}1 & 0 \\ -1 & 1\end{pmatrix}^{\otimes n}=\begin{pmatrix}\dots \\ \vdots \\ \dots \\ \begin{pmatrix}-1 & 1\end{pmatrix}^{\otimes n}\end{pmatrix}$

$\begin{pmatrix}-1 & 1\end{pmatrix}^{\otimes n}$ 就是容斥反演公式

