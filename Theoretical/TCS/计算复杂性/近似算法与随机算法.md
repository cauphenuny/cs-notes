## 近似算法

> [!def] MIN-VERTEX-COVER
> 在所有的顶点覆盖中找到最小的

> [!solution]
> $A=$"对输入 $\langle G \rangle$，$G$ 是一个无向图：
> 1. 重复下列操作直到 $G$ 中所有边都和有标记的边相邻
> 	1. 在 $G$ 中找一条不与任何有标记的边相邻的边
> 	2. 给这条边作标记
> 2. 输出所有有标记的边的顶点。

> [!theorem]
> 这个算法是2-优的（找到的解大小不超过最小解的两倍）

> [!proof]
> 考虑最小顶点覆盖 $X$ 和 有标记的边集 $Y$，给出的结果 $Z$ 
> - $|Y| \leq |X|$: 因为$Y$ 中每一条边都要被覆盖，而且 $Y$ 中不存在相邻边，因此每一条边至少要求一个覆盖点
> - $|Z|=2|Y|$

---

## 随机算法

> [!def] 概率图灵机
> 每一个非确定性步称为 **掷硬币步**，有两个合法下一步
> 对于一个分支 $b$，它的概率是 $2^{-k}$，其中 $k$ 是掷硬币次数
> $\text{Pr}[M \text{接受}\omega]=\sum_{\text{b是接受分支}}\Pr[b]$
> $\Pr_{\text{拒绝}}=1-\Pr_{\text{接受}}$

> [!def] 以错误概率判定
> 若
> - $w \in A\longrightarrow \Pr[M \text{ 接受 }w]\geq 1-\varepsilon$
> - $w \not\in A \longrightarrow \Pr[M\text{ 拒绝 }w]\geq 1-\varepsilon$
> 
> 则称 $M$ 以错误概率 $\varepsilon$ 判定 $A$

> [!def] BPP
> **B**ounded-error **P**robabilistic **P**olynomial time
> 是**多项式时间**概率图灵机 以错误概率 $1 / 3$ 判定的语言类
> $$
A \in \text{BPP} \Longleftrightarrow \exists \text{PP} M, \begin{cases}
w \in A \longrightarrow \Pr[M 接受 w] \geq \dfrac{2}{3} \\
w \not\in A \longrightarrow \Pr[M \text{ 拒绝 }w] \geq \dfrac{2}{3}
\end{cases}
$$

为什么是 $\dfrac{1}{3}$? 其实无所谓

> [!theorem] Amplification Lemma
> 设 $\varepsilon \in(0, 1/2)$ 是给定的常数，设 $M_{1}$  是错误概率为 $\varepsilon$ 的多项式时间概率图灵机，则对于任意多项式 $p(n)$ 存在错误概率为 $2^{-p(n)}$ 的多项式时间概率图灵机 $M_{2}$

很直观，因为错误概率不超过 $\dfrac{1}{2}$，运行多次取大部结果即可

---

素性问题

判定伪素数的一个随机算法：
对于数 $p$ ，随机取 $a_{i}$，检验是否有 $a_{i}^p \equiv 1 \pmod p$，若去了 $k$ 个都有费马小定理成立，则宣称 $p$ 是质数，反之为合数

对于非伪素数而言，最多有 $1 / 2$ 的概率使得式子成立

---

> [!def] RP
> 多项式时间概率图灵机识别的语言类，在这里, 在语言中的输入以不小于 $\dfrac{1}{2}$ 的概率被接受；不在语言中的输入以概率  $1$ 被拒绝。
> 即：$A \in\text{RP} \Longleftrightarrow \begin{cases} w \in A\implies \Pr_{\text{接受}}\geq \dfrac{1}{2}\\w\not\in A\implies\Pr_{\text{拒绝}}=1\end{cases}$

概率不一定要 $\dfrac{1}{2}$，也可以是关于 $n$ 的多项式 $p(n)$ 可变的值 $\dfrac{1}{p(n)}$
这样错误概率是 $1- \dfrac{1}{p(n)}$
重复运行 $p(n)$ 次：错误概率 $\left( 1- \dfrac{1}{p(n)} \right)^{p(n)}=\dfrac{1}{\left( 1+\dfrac{1}{p(n)-1} \right)^{p(n)}}=\dfrac{1}{e} < \dfrac{1}{2}$
总时间复杂度仍然是多项式的

> [!def] coRP
> $\text{coRP}=\{ A \mid \bar{A}\in\text{RP} \}$
> 即：$A \in\text{coRP} \Longleftrightarrow \begin{cases} w \in A\implies \Pr_{\text{接受}}=1\\w\not\in A\implies\Pr_{\text{拒绝}}\geq \dfrac{1}{2}\end{cases}$

> [!theorem]
> $\text{P}\subseteq\text{RP}\subseteq\text{NP}$

> [!proof]
> - $\text{P}\subseteq\text{RP}$: 显然
> - $\text{RP}\subseteq\text{NP}$: $\text{RP}$ 要求成功概率 $\dfrac{1}{p(n)}$，$\text{NP}$ 只要存在接受计算就行

$\text{RP}$ 对成功率的要求比 $\text{NP}$ 高，若直接将一个 $\text{NP}$ 机器 $M$ 看成概率图灵机，它最小的成功率是 $\dfrac{1}{2^{\text{Time(M)}}}$，是指数阶的

---

> [!def] ZPP
> $A\in\text{ZPP}$ 当且仅当存在多项式时间概率图灵机 $M$ 满足：
> - $\forall w, M(w)\in \{ 0,1,\perp \}$
> - $\text{if }w \in A,M(w)\in \{ 1,\perp \}$
> - $\text{if }w \not\in A,M(w)\in \{ 0,\perp \}$
> - $\forall w,Pr[M(w)=\perp]\leq \dfrac{1}{2}$

> [!theorem]
> $\text{ZPP}=\text{RP}\cap\text{coRP}$

> [!proof]
> ![[ZPP.png]]

理解：一个永远不会输出错误答案的概率图灵机

---

> [!theorem]
> $\text{P}\subseteq\text{ZPP}=\text{RP}\cap\text{coRP}$
> $\text{RP}\subseteq\text{NP},\text{RP}\subseteq\text{BPP}$
> $\text{coRP}\subseteq\text{coNP},\text{coRP}\subseteq\text{BPP}$

![[P-hierachy.png|301x258]]]