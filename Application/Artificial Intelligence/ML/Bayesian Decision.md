建模为 最小化条件风险 问题，模型的输入是条件

1. 计算后验概率
2. 计算条件风险
3. 最小化条件风险

---

> [!def] 共轭先验：
> **共轭先验（conjugate prior）是为方便 Bayesian 推断而特别选择的一类先验分布。**
> 
>   
> 
> 一句话总结：
> 
>   
> 
> > **选一个先验，使得后验分布和先验属于同一分布族，这样计算就非常容易，甚至可以写出解析解。**
> 
> ---
> 
> # **🧠 为什么需要共轭先验？**
> 
>   
> 
> 做贝叶斯推断时：
> 
>   
> 
> \text{Posterior} \propto \text{Likelihood} \times \text{Prior}
> 
>   
> 
> 一般来说，乘起来的形式可能很复杂，后验分布很难求。
> 
>   
> 
> 但是如果你聪明地选 prior，使得：
> 
> - 后验的形式和先验一样（比如先验是 Beta，那么后验也是 Beta）
>     
> - 只需要更新参数，不需要改变分布的形式
>     
> 
>   
> 
> 那么整个贝叶斯推断就会变成简单的加减法。
> 
>   
> 
> => **这就是共轭先验。**
> 
> ---
> 
> # **🎯 例子：伯努利/二项分布的共轭先验是 Beta**
> 
>   
> 
> 假设你 toss 硬币，likelihood 是 Bernoulli(p) 或 Binomial(n, p)：
> 
>   
> 
> L(p) = p^{k}(1-p)^{n-k}
> 
>   
> 
> 如果先验选择 Beta(α, β)：
> 
>   
> 
> \text{Prior}(p) = p^{\alpha-1}(1-p)^{\beta-1}
> 
>   
> 
> 两者相乘：
> 
>   
> 
> p^{k+\alpha-1}(1-p)^{n-k+\beta-1}
> 
>   
> 
> 这仍然是一个 Beta 分布，只是参数更新了：
> 
>   
> 
> p \mid \text{data} \sim \text{Beta}(\alpha + k, \beta + n-k)
> 
>   
> 
> ➡ 这就是共轭的力量：**后验是 Beta**，你不会得到一个奇奇怪怪的新分布。
> 
> ---
> 
> # **🪄 共轭先验的意义**
> 
>   
> 
> ### **✔ 1. 后验保持封闭形式（closed form）**
> 
>   
> 
> 你不用做高维积分或数值优化。
> 
>   
> 
> ### **✔ 2. 参数更新简单**
> 
>   
> 
> 通常就是加数据、加计数。
> 
>   
> 
> ### **✔ 3. 计算便宜**
> 
>   
> 
> 在早期（计算机弱）时代尤其重要，但今天在变分推断、MCMC里仍然深有价值。
> 
>   
> 
> ### **✔ 4. 理论漂亮**
> 
>   
> 
> 能优雅地保持信息结构（指数族 + 共轭先验的经典结论）。
> 
> ---
> 
> # **📚 一般结论：指数族分布都有共轭先验**
> 
>   
> 
> 如果 likelihood 属于指数族，比如：
> 
> - 伯努利 / 二项（→ Beta）
>     
> - 泊松（→ Gamma）
>     
> - 指数分布（→ Gamma）
>     
> - 高斯均值未知（→ 正态）
>     
> - 高斯均值与方差都未知（→ Normal-Inverse-Gamma）
>     
> 
>   
> 
> 它们都有一个匹配的共轭先验。
> 
>   
> 
> > 共轭先验通常就是“与似然形式一致”的分布。
> 
> ---
> 
> # **⭐ 总结（超简洁）**
> 
> - **共轭先验 = 一个先验分布，与似然相乘后仍保持相同的分布形式。**
>     
> - 用它可以：
>     
>     - 轻松求后验
>         
>     - 只更新参数
>         
>     - 保持解析解
>         
>     
> 
>   
> 
> 如果你需要，我可以给你一个更 formal 的数学定义，或者给你做一个“指数族共轭先验推导”的更深入版。